GoogleAuthenticatorDotNet
=========================

This is a class library that generated and authenticates 2FA codes 
according to the [RFC6238](http://tools.ietf.org/html/rfc6238) specifications, 
as well as the implementation of [Google Authenticator](https://github.com/google/google-authenticator).

## Usage

The `Authenticator` static class encapsulates all necessary functions to generate 
and authenticate 2FA codes (OTPs) and secret keys for use of your app's users.

### Secret keys

Each authenticating user has to have a secret key associated with them. This has to be persisted on both server and client
(the user's Google Authenticator app) and represents the seed from which 2FA codes are generated.

Secret keys are also __base 32__. `Authenticator.GenerateSecret()` is a utility function designed for generating 
random strings of text that are compatible with [RFC3548 Base 32 specifications](http://tools.ietf.org/html/rfc3548#section-5).

    using GoogleAuthenticator;
    
    // by default, generated secret keys are 16 characters long
    var secret = Authenticator.GenerateSecret();
    
    // alternatively specify secret key length as well
    var longSecret = Authenticator.GenerateSecret(32);

Secret keys should be given to the user somehow, and must be registered in their Google Authenticator app.
Once registered in their GA app, it should be able to start generating 6-digit OTPs.

### Authenticating OTPs

To validate a user-provided OTP, call the `Authenticator.Authenticate()` method using the OTP and the secret key
associated with the user.

    using GoogleAuthenticator;
    
    // to authenticate :
    var secret = "ABCDABCDABCDABCD";   // this should be stored and associated with the user somewhere server-side
                                       // this should NOT be given to you by the user themselves.
                                       
    var otp    = "123456";             // this, on the other hand, SHOULD BE PROVIDED by the user.
                                       // ideally, this is generated by the GA app.
    
    var isAuthenticated = Authenticator.Authenticate(secret, otp);

Generated OTPs are time-sensitive, so to allow for a bit of leeway when authenticating
(e.g. to account for slow connections), `.Authenticate()` accepts a `leeway` argument as its third argument.

`leeway` is defined as the number of seconds `+/-` applied to the current date and time, 
wherein any OTP valid within that timeframe is considered to be valid.

    // e.g. any OTP that is valid during the current date and time, +/- 15 seconds,
    //      will be accepted.
    var isLooselyAuthenticated = Authenticator.Authenticate(secret, otp, 15);

## License

See [LICENSE](https://github.com/richardneililagan/GoogleAuthenticatorDotNet/blob/master/LICENSE.txt).
